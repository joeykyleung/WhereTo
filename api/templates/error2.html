{% extends "layout.html" %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename = 'error.css')}}" />
{% endblock %}

{% block body %}
    <!-- <div class="bg-img"><img src="/static/bg.jpg" alt="background image"></div> -->
    <div class="container">

        <form class="form-inline" id="attractions" action="/attractions" method="post">
                <input type="hidden" name="inputPostCode" id="inputPostCode" value="{{ inputPostCode }}">
            <button hidden="hidden" type="submit" class="btn btn-primary mb-2 input"> Find out </button>
        </form>
        <div>
            <h4>Please wait while we are loading the results...</h4>
            <script>
                {#setTimeout('Redirect()', 5000);#}
                {#function Redirect() {#}
                {#    document.getElementById("attractions").submit()#}

                function checkLoading() {
                  fetch('/check_loading')
                    .then(response => response.json())
                    .then(data => {
                      if (data.loaded) {
                        document.getElementById("attractions").submit();
                      } else {
                        setTimeout(checkLoading, 2000);
                      }
                    })
                    .catch(error => {
                      console.error('Error:', error);
                    });
                }
                window.onload = checkLoading;
            </script>
        </div>
{#        <a href="/" class="btn btn-primary mb-2 fade-in" >Take me home!</a>#}
    </div>

{% endblock %}